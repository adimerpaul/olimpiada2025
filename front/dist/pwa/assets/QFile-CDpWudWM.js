import{j as We,aD as Xe,aE as Ye,aF as Ge,aG as Je,x as Rt,g as He,r as P,k as d,I as Ce,$ as se,H as Lt,a9 as Ht,K as Pt,L as Nt,M as ht,l as V,as as yt,aH as bt,aI as Re,aJ as jt,aK as ke,aL as $t,A as Be,E as ce,aM as Kt,aN as Qt,d as Ut,B as Se,ay as Wt,h as Xt,O as Yt,s as Gt,aO as Jt,aP as Zt,aw as el}from"./index-DjedoNJp.js";import{Q as pt}from"./QChip-C0nkFCr8.js";import{a as tl,b as ll,Q as ul}from"./QItemLabel-pqPkR3Fl.js";import{n as vt,Q as nl,i as il}from"./format-C8w485Ck.js";const al=We({name:"QField",inheritAttrs:!1,props:{...Ye,tag:{type:String,default:"label"}},emits:Xe,setup(){return Ge(Je({tagProp:!0}))}});let Le=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const o=document.createElement("div");Object.assign(o.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(o),e.scrollLeft=-1e3,Le=e.scrollLeft>=0,e.remove()}const Z=1e3,ol=["start","center","end","start-force","center-force","end-force"],wt=Array.prototype.filter,rl=window.getComputedStyle(document.body).overflowAnchor===void 0?Rt:function(e,o){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const r=e.children||[];wt.call(r,S=>S.dataset&&S.dataset.qVsAnchor!==void 0).forEach(S=>{delete S.dataset.qVsAnchor});const v=r[o];v?.dataset&&(v.dataset.qVsAnchor="")}))};function xe(e,o){return e+o}function Qe(e,o,r,v,S,u,q,m){const g=e===window?document.scrollingElement||document.documentElement:e,B=S===!0?"offsetWidth":"offsetHeight",s={scrollStart:0,scrollViewSize:-q-m,scrollMaxSize:0,offsetStart:-q,offsetEnd:-m};if(S===!0?(e===window?(s.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,s.scrollViewSize+=document.documentElement.clientWidth):(s.scrollStart=g.scrollLeft,s.scrollViewSize+=g.clientWidth),s.scrollMaxSize=g.scrollWidth,u===!0&&(s.scrollStart=(Le===!0?s.scrollMaxSize-s.scrollViewSize:0)-s.scrollStart)):(e===window?(s.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,s.scrollViewSize+=document.documentElement.clientHeight):(s.scrollStart=g.scrollTop,s.scrollViewSize+=g.clientHeight),s.scrollMaxSize=g.scrollHeight),r!==null)for(let C=r.previousElementSibling;C!==null;C=C.previousElementSibling)C.classList.contains("q-virtual-scroll--skip")===!1&&(s.offsetStart+=C[B]);if(v!==null)for(let C=v.nextElementSibling;C!==null;C=C.nextElementSibling)C.classList.contains("q-virtual-scroll--skip")===!1&&(s.offsetEnd+=C[B]);if(o!==e){const C=g.getBoundingClientRect(),x=o.getBoundingClientRect();S===!0?(s.offsetStart+=x.left-C.left,s.offsetEnd-=x.width):(s.offsetStart+=x.top-C.top,s.offsetEnd-=x.height),e!==window&&(s.offsetStart+=s.scrollStart),s.offsetEnd+=s.scrollMaxSize-s.offsetStart}return s}function mt(e,o,r,v){o==="end"&&(o=(e===window?document.body:e)[r===!0?"scrollWidth":"scrollHeight"]),e===window?r===!0?(v===!0&&(o=(Le===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-o),window.scrollTo(o,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,o):r===!0?(v===!0&&(o=(Le===!0?e.scrollWidth-e.offsetWidth:0)-o),e.scrollLeft=o):e.scrollTop=o}function Ie(e,o,r,v){if(r>=v)return 0;const S=o.length,u=Math.floor(r/Z),q=Math.floor((v-1)/Z)+1;let m=e.slice(u,q).reduce(xe,0);return r%Z!==0&&(m-=o.slice(u*Z,r).reduce(xe,0)),v%Z!==0&&v!==S&&(m-=o.slice(v,q*Z).reduce(xe,0)),m}const sl={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},St={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...sl};function cl({virtualScrollLength:e,getVirtualScrollTarget:o,getVirtualScrollEl:r,virtualScrollItemSizeComputed:v}){const S=He(),{props:u,emit:q,proxy:m}=S,{$q:g}=m;let B,s,C,x=[],k;const D=P(0),F=P(0),R=P({}),X=P(null),c=P(null),E=P(null),O=P({from:0,to:0}),ee=d(()=>u.tableColspan!==void 0?u.tableColspan:100);v===void 0&&(v=d(()=>u.virtualScrollItemSize));const f=d(()=>v.value+";"+u.virtualScrollHorizontal),L=d(()=>f.value+";"+u.virtualScrollSliceRatioBefore+";"+u.virtualScrollSliceRatioAfter);Ce(L,()=>{J()}),Ce(f,U);function U(){oe(s,!0)}function A(l){oe(l===void 0?s:l)}function T(l,a){const y=o();if(y==null||y.nodeType===8)return;const _=Qe(y,r(),X.value,c.value,u.virtualScrollHorizontal,g.lang.rtl,u.virtualScrollStickySizeStart,u.virtualScrollStickySizeEnd);C!==_.scrollViewSize&&J(_.scrollViewSize),W(y,_,Math.min(e.value-1,Math.max(0,parseInt(l,10)||0)),0,ol.indexOf(a)!==-1?a:s!==-1&&l>s?"end":"start")}function ie(){const l=o();if(l==null||l.nodeType===8)return;const a=Qe(l,r(),X.value,c.value,u.virtualScrollHorizontal,g.lang.rtl,u.virtualScrollStickySizeStart,u.virtualScrollStickySizeEnd),y=e.value-1,_=a.scrollMaxSize-a.offsetStart-a.offsetEnd-F.value;if(B===a.scrollStart)return;if(a.scrollMaxSize<=0){W(l,a,0,0);return}C!==a.scrollViewSize&&J(a.scrollViewSize),ae(O.value.from);const j=Math.floor(a.scrollMaxSize-Math.max(a.scrollViewSize,a.offsetEnd)-Math.min(k[y],a.scrollViewSize/2));if(j>0&&Math.ceil(a.scrollStart)>=j){W(l,a,y,a.scrollMaxSize-a.offsetEnd-x.reduce(xe,0));return}let z=0,w=a.scrollStart-a.offsetStart,$=w;if(w<=_&&w+a.scrollViewSize>=D.value)w-=D.value,z=O.value.from,$=w;else for(let b=0;w>=x[b]&&z<y;b++)w-=x[b],z+=Z;for(;w>0&&z<y;)w-=k[z],w>-a.scrollViewSize?(z++,$=w):$=k[z]+w;W(l,a,z,$)}function W(l,a,y,_,j){const z=typeof j=="string"&&j.indexOf("-force")!==-1,w=z===!0?j.replace("-force",""):j,$=w!==void 0?w:"start";let b=Math.max(0,y-R.value[$]),Y=b+R.value.total;Y>e.value&&(Y=e.value,b=Math.max(0,Y-R.value.total)),B=a.scrollStart;const re=b!==O.value.from||Y!==O.value.to;if(re===!1&&w===void 0){N(y);return}const{activeElement:Oe}=document,ne=E.value;re===!0&&ne!==null&&ne!==Oe&&ne.contains(Oe)===!0&&(ne.addEventListener("focusout",le),setTimeout(()=>{ne?.removeEventListener("focusout",le)})),rl(ne,y-b);const Me=w!==void 0?k.slice(b,y).reduce(xe,0):0;if(re===!0){const de=Y>=O.value.from&&b<=O.value.to?O.value.to:Y;O.value={from:b,to:de},D.value=Ie(x,k,0,b),F.value=Ie(x,k,Y,e.value),requestAnimationFrame(()=>{O.value.to!==Y&&B===a.scrollStart&&(O.value={from:O.value.from,to:Y},F.value=Ie(x,k,Y,e.value))})}requestAnimationFrame(()=>{if(B!==a.scrollStart)return;re===!0&&ae(b);const de=k.slice(b,y).reduce(xe,0),fe=de+a.offsetStart+D.value,qe=fe+k[y];let Fe=fe+_;if(w!==void 0){const Pe=de-Me,ze=a.scrollStart+Pe;Fe=z!==!0&&ze<fe&&qe<ze+a.scrollViewSize?ze:w==="end"?qe-a.scrollViewSize:fe-(w==="start"?0:Math.round((a.scrollViewSize-k[y])/2))}B=Fe,mt(l,Fe,u.virtualScrollHorizontal,g.lang.rtl),N(y)})}function ae(l){const a=E.value;if(a){const y=wt.call(a.children,b=>b.classList&&b.classList.contains("q-virtual-scroll--skip")===!1),_=y.length,j=u.virtualScrollHorizontal===!0?b=>b.getBoundingClientRect().width:b=>b.offsetHeight;let z=l,w,$;for(let b=0;b<_;){for(w=j(y[b]),b++;b<_&&y[b].classList.contains("q-virtual-scroll--with-prev")===!0;)w+=j(y[b]),b++;$=w-k[z],$!==0&&(k[z]+=$,x[Math.floor(z/Z)]+=$),z++}}}function le(){E.value?.focus()}function oe(l,a){const y=1*v.value;(a===!0||Array.isArray(k)===!1)&&(k=[]);const _=k.length;k.length=e.value;for(let z=e.value-1;z>=_;z--)k[z]=y;const j=Math.floor((e.value-1)/Z);x=[];for(let z=0;z<=j;z++){let w=0;const $=Math.min((z+1)*Z,e.value);for(let b=z*Z;b<$;b++)w+=k[b];x.push(w)}s=-1,B=void 0,D.value=Ie(x,k,0,O.value.from),F.value=Ie(x,k,O.value.to,e.value),l>=0?(ae(O.value.from),se(()=>{T(l)})):K()}function J(l){if(l===void 0&&typeof window<"u"){const w=o();w!=null&&w.nodeType!==8&&(l=Qe(w,r(),X.value,c.value,u.virtualScrollHorizontal,g.lang.rtl,u.virtualScrollStickySizeStart,u.virtualScrollStickySizeEnd).scrollViewSize)}C=l;const a=parseFloat(u.virtualScrollSliceRatioBefore)||0,y=parseFloat(u.virtualScrollSliceRatioAfter)||0,_=1+a+y,j=l===void 0||l<=0?1:Math.ceil(l/v.value),z=Math.max(1,j,Math.ceil((u.virtualScrollSliceSize>0?u.virtualScrollSliceSize:10)/_));R.value={total:Math.ceil(z*_),start:Math.ceil(z*a),center:Math.ceil(z*(.5+a)),end:Math.ceil(z*(1+a)),view:j}}function p(l,a){const y=u.virtualScrollHorizontal===!0?"width":"height",_={["--q-virtual-scroll-item-"+y]:v.value+"px"};return[l==="tbody"?V(l,{class:"q-virtual-scroll__padding",key:"before",ref:X},[V("tr",[V("td",{style:{[y]:`${D.value}px`,..._},colspan:ee.value})])]):V(l,{class:"q-virtual-scroll__padding",key:"before",ref:X,style:{[y]:`${D.value}px`,..._}}),V(l,{class:"q-virtual-scroll__content",key:"content",ref:E,tabindex:-1},a.flat()),l==="tbody"?V(l,{class:"q-virtual-scroll__padding",key:"after",ref:c},[V("tr",[V("td",{style:{[y]:`${F.value}px`,..._},colspan:ee.value})])]):V(l,{class:"q-virtual-scroll__padding",key:"after",ref:c,style:{[y]:`${F.value}px`,..._}})]}function N(l){s!==l&&(u.onVirtualScroll!==void 0&&q("virtualScroll",{index:l,from:O.value.from,to:O.value.to-1,direction:l<s?"decrease":"increase",ref:m}),s=l)}J();const K=Lt(ie,g.platform.is.ios===!0?120:35);Ht(()=>{J()});let ue=!1;return Pt(()=>{ue=!0}),Nt(()=>{if(ue!==!0)return;const l=o();B!==void 0&&l!==void 0&&l!==null&&l.nodeType!==8?mt(l,B,u.virtualScrollHorizontal,g.lang.rtl):T(s)}),ht(()=>{K.cancel()}),Object.assign(m,{scrollTo:T,reset:U,refresh:A}),{virtualScrollSliceRange:O,virtualScrollSliceSizeComputed:R,setVirtualScrollSize:J,onVirtualScrollEvt:K,localResetVirtualScroll:oe,padVirtualScroll:p,scrollTo:T,reset:U,refresh:A}}const gt=e=>["add","add-unique","toggle"].includes(e),dl=".*+?^${}()|[]\\",fl=Object.keys(Ye);function Ue(e,o){if(typeof e=="function")return e;const r=e!==void 0?e:o;return v=>v!==null&&typeof v=="object"&&r in v?v[r]:v}const pl=We({name:"QSelect",inheritAttrs:!1,props:{...St,...yt,...Ye,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:gt},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:St.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...Xe,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:o,emit:r}){const{proxy:v}=He(),{$q:S}=v,u=P(!1),q=P(!1),m=P(-1),g=P(""),B=P(!1),s=P(!1);let C=null,x=null,k,D,F,R=null,X,c,E,O;const ee=P(null),f=P(null),L=P(null),U=P(null),A=P(null),T=bt(e),ie=jt(rt),W=d(()=>Array.isArray(e.options)?e.options.length:0),ae=d(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:le,virtualScrollSliceSizeComputed:oe,localResetVirtualScroll:J,padVirtualScroll:p,onVirtualScrollEvt:N,scrollTo:K,setVirtualScrollSize:ue}=cl({virtualScrollLength:W,getVirtualScrollTarget:Ft,getVirtualScrollEl:at,virtualScrollItemSizeComputed:ae}),l=Je(),a=d(()=>{const t=e.mapOptions===!0&&e.multiple!==!0,n=e.modelValue!==void 0&&(e.modelValue!==null||t===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const i=e.mapOptions===!0&&k!==void 0?k:[],h=n.map(M=>xt(M,i));return e.modelValue===null&&t===!0?h.filter(M=>M!==null):h}return n}),y=d(()=>{const t={};return fl.forEach(n=>{const i=e[n];i!==void 0&&(t[n]=i)}),t}),_=d(()=>e.optionsDark===null?l.isDark.value:e.optionsDark),j=d(()=>Re(a.value)),z=d(()=>{let t="q-field__input q-placeholder col";return e.hideSelected===!0||a.value.length===0?[t,e.inputClass]:(t+=" q-field__input--padding",e.inputClass===void 0?t:[t,e.inputClass])}),w=d(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),$=d(()=>W.value===0),b=d(()=>a.value.map(t=>G.value(t)).join(", ")),Y=d(()=>e.displayValue!==void 0?e.displayValue:b.value),re=d(()=>e.optionsHtml===!0?()=>!0:t=>t?.html===!0),Oe=d(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||a.value.some(re.value))),ne=d(()=>l.focused.value===!0?e.tabindex:-1),Me=d(()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":u.value===!0?"true":"false","aria-controls":`${l.targetUid.value}_lb`};return m.value>=0&&(t["aria-activedescendant"]=`${l.targetUid.value}_${m.value}`),t}),de=d(()=>({id:`${l.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),fe=d(()=>a.value.map((t,n)=>({index:n,opt:t,html:re.value(t),selected:!0,removeAtIndex:Ct,toggleOption:ve,tabindex:ne.value}))),qe=d(()=>{if(W.value===0)return[];const{from:t,to:n}=le.value;return e.options.slice(t,n).map((i,h)=>{const M=ge.value(i)===!0,I=je(i)===!0,Q=t+h,H={clickable:!0,active:I,activeClass:ze.value,manualFocus:!0,focused:!1,disable:M,tabindex:-1,dense:e.optionsDense,dark:_.value,role:"option","aria-selected":I===!0?"true":"false",id:`${l.targetUid.value}_${Q}`,onClick:()=>{ve(i)}};return M!==!0&&(m.value===Q&&(H.focused=!0),S.platform.is.desktop===!0&&(H.onMousemove=()=>{u.value===!0&&he(Q)})),{index:Q,opt:i,html:re.value(i),label:G.value(i),selected:H.active,focused:H.focused,toggleOption:ve,setOptionIndex:he,itemProps:H}})}),Fe=d(()=>e.dropdownIcon!==void 0?e.dropdownIcon:S.iconSet.arrow.dropdown),Pe=d(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),ze=d(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),te=d(()=>Ue(e.optionValue,"value")),G=d(()=>Ue(e.optionLabel,"label")),ge=d(()=>Ue(e.optionDisable,"disable")),_e=d(()=>a.value.map(te.value)),Vt=d(()=>{const t={onInput:rt,onChange:ie,onKeydown:it,onKeyup:ut,onKeypress:nt,onFocus:tt,onClick(n){D===!0&&Se(n)}};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=ie,t});Ce(a,t=>{k=t,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&l.innerLoading.value!==!0&&(q.value!==!0&&u.value!==!0||j.value!==!0)&&(F!==!0&&we(),(q.value===!0||u.value===!0)&&ye(""))},{immediate:!0}),Ce(()=>e.fillInput,we),Ce(u,$e),Ce(W,Bt);function Ze(t){return e.emitValue===!0?te.value(t):t}function Ne(t){if(t!==-1&&t<a.value.length)if(e.multiple===!0){const n=e.modelValue.slice();r("remove",{index:t,value:n.splice(t,1)[0]}),r("update:modelValue",n)}else r("update:modelValue",null)}function Ct(t){Ne(t),l.focus()}function et(t,n){const i=Ze(t);if(e.multiple!==!0){e.fillInput===!0&&Ae(G.value(t),!0,!0),r("update:modelValue",i);return}if(a.value.length===0){r("add",{index:0,value:i}),r("update:modelValue",e.multiple===!0?[i]:i);return}if(n===!0&&je(t)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const h=e.modelValue.slice();r("add",{index:h.length,value:i}),h.push(i),r("update:modelValue",h)}function ve(t,n){if(l.editable.value!==!0||t===void 0||ge.value(t)===!0)return;const i=te.value(t);if(e.multiple!==!0){n!==!0&&(Ae(e.fillInput===!0?G.value(t):"",!0,!0),me()),f.value?.focus(),(a.value.length===0||ke(te.value(a.value[0]),i)!==!0)&&r("update:modelValue",e.emitValue===!0?i:t);return}if((D!==!0||B.value===!0)&&l.focus(),tt(),a.value.length===0){const I=e.emitValue===!0?i:t;r("add",{index:0,value:I}),r("update:modelValue",e.multiple===!0?[I]:I);return}const h=e.modelValue.slice(),M=_e.value.findIndex(I=>ke(I,i));if(M!==-1)r("remove",{index:M,value:h.splice(M,1)[0]});else{if(e.maxValues!==void 0&&h.length>=e.maxValues)return;const I=e.emitValue===!0?i:t;r("add",{index:h.length,value:I}),h.push(I)}r("update:modelValue",h)}function he(t){if(S.platform.is.desktop!==!0)return;const n=t!==-1&&t<W.value?t:-1;m.value!==n&&(m.value=n)}function Ee(t=1,n){if(u.value===!0){let i=m.value;do i=vt(i+t,-1,W.value-1);while(i!==-1&&i!==m.value&&ge.value(e.options[i])===!0);m.value!==i&&(he(i),K(i),n!==!0&&e.useInput===!0&&e.fillInput===!0&&Te(i>=0?G.value(e.options[i]):X,!0))}}function xt(t,n){const i=h=>ke(te.value(h),t);return e.options.find(i)||n.find(i)||t}function je(t){const n=te.value(t);return _e.value.find(i=>ke(i,n))!==void 0}function tt(t){e.useInput===!0&&f.value!==null&&(t===void 0||f.value===t.target&&t.target.value===b.value)&&f.value.select()}function lt(t){Wt(t,27)===!0&&u.value===!0&&(Se(t),me(),we()),r("keyup",t)}function ut(t){const{value:n}=t.target;if(t.keyCode!==void 0){lt(t);return}if(t.target.value="",C!==null&&(clearTimeout(C),C=null),x!==null&&(clearTimeout(x),x=null),we(),typeof n=="string"&&n.length!==0){const i=n.toLocaleLowerCase(),h=I=>{const Q=e.options.find(H=>String(I.value(H)).toLocaleLowerCase()===i);return Q===void 0?!1:(a.value.indexOf(Q)===-1?ve(Q):me(),!0)},M=I=>{h(te)!==!0&&I!==!0&&h(G)!==!0&&ye(n,!0,()=>M(!0))};M()}else l.clearValue(t)}function nt(t){r("keypress",t)}function it(t){if(r("keydown",t),$t(t)===!0)return;const n=g.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),i=t.shiftKey!==!0&&e.disableTabSelection!==!0&&e.multiple!==!0&&(m.value!==-1||n===!0);if(t.keyCode===27){Be(t);return}if(t.keyCode===9&&i===!1){be();return}if(t.target===void 0||t.target.id!==l.targetUid.value||l.editable.value!==!0)return;if(t.keyCode===40&&l.innerLoading.value!==!0&&u.value===!1){ce(t),pe();return}if(t.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&g.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?Ne(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&r("update:modelValue",null);return}(t.keyCode===35||t.keyCode===36)&&(typeof g.value!="string"||g.value.length===0)&&(ce(t),m.value=-1,Ee(t.keyCode===36?1:-1,e.multiple)),(t.keyCode===33||t.keyCode===34)&&oe.value!==void 0&&(ce(t),m.value=Math.max(-1,Math.min(W.value,m.value+(t.keyCode===33?-1:1)*oe.value.view)),Ee(t.keyCode===33?1:-1,e.multiple)),(t.keyCode===38||t.keyCode===40)&&(ce(t),Ee(t.keyCode===38?-1:1,e.multiple));const h=W.value;if((E===void 0||O<Date.now())&&(E=""),h>0&&e.useInput!==!0&&t.key!==void 0&&t.key.length===1&&t.altKey===!1&&t.ctrlKey===!1&&t.metaKey===!1&&(t.keyCode!==32||E.length!==0)){u.value!==!0&&pe(t);const M=t.key.toLocaleLowerCase(),I=E.length===1&&E[0]===M;O=Date.now()+1500,I===!1&&(ce(t),E+=M);const Q=new RegExp("^"+E.split("").map(Ke=>dl.indexOf(Ke)!==-1?"\\"+Ke:Ke).join(".*"),"i");let H=m.value;if(I===!0||H<0||Q.test(G.value(e.options[H]))!==!0)do H=vt(H+1,-1,h-1);while(H!==m.value&&(ge.value(e.options[H])===!0||Q.test(G.value(e.options[H]))!==!0));m.value!==H&&se(()=>{he(H),K(H),H>=0&&e.useInput===!0&&e.fillInput===!0&&Te(G.value(e.options[H]),!0)});return}if(!(t.keyCode!==13&&(t.keyCode!==32||e.useInput===!0||E!=="")&&(t.keyCode!==9||i===!1))){if(t.keyCode!==9&&ce(t),m.value!==-1&&m.value<h){ve(e.options[m.value]);return}if(n===!0){const M=(I,Q)=>{if(Q){if(gt(Q)!==!0)return}else Q=e.newValueMode;if(Ae("",e.multiple!==!0,!0),I==null)return;(Q==="toggle"?ve:et)(I,Q==="add-unique"),e.multiple!==!0&&(f.value?.focus(),me())};if(e.onNewValue!==void 0?r("newValue",g.value,M):M(g.value),e.multiple!==!0)return}u.value===!0?be():l.innerLoading.value!==!0&&pe()}}function at(){return D===!0?A.value:L.value!==null&&L.value.contentEl!==null?L.value.contentEl:void 0}function Ft(){return at()}function zt(){return e.hideSelected===!0?[]:o["selected-item"]!==void 0?fe.value.map(t=>o["selected-item"](t)).slice():o.selected!==void 0?[].concat(o.selected()):e.useChips===!0?fe.value.map((t,n)=>V(pt,{key:"option-"+n,removable:l.editable.value===!0&&ge.value(t.opt)!==!0,dense:!0,textColor:e.color,tabindex:ne.value,onRemove(){t.removeAtIndex(n)}},()=>V("span",{class:"ellipsis",[t.html===!0?"innerHTML":"textContent"]:G.value(t.opt)}))):[V("span",{class:"ellipsis",[Oe.value===!0?"innerHTML":"textContent"]:Y.value})]}function ot(){if($.value===!0)return o["no-option"]!==void 0?o["no-option"]({inputValue:g.value}):void 0;const t=o.option!==void 0?o.option:i=>V(ul,{key:i.index,...i.itemProps},()=>V(tl,()=>V(ll,()=>V("span",{[i.html===!0?"innerHTML":"textContent"]:i.label}))));let n=p("div",qe.value.map(t));return o["before-options"]!==void 0&&(n=o["before-options"]().concat(n)),Yt(o["after-options"],n)}function At(t,n){const i=n===!0?{...Me.value,...l.splitAttrs.attributes.value}:void 0,h={ref:n===!0?f:void 0,key:"i_t",class:z.value,style:e.inputStyle,value:g.value!==void 0?g.value:"",type:"search",...i,id:n===!0?l.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":t===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Vt.value};return t!==!0&&D===!0&&(Array.isArray(h.class)===!0?h.class=[...h.class,"no-pointer-events"]:h.class+=" no-pointer-events"),V("input",h)}function rt(t){C!==null&&(clearTimeout(C),C=null),x!==null&&(clearTimeout(x),x=null),!(t&&t.target&&t.target.qComposing===!0)&&(Te(t.target.value||""),F=!0,X=g.value,l.focused.value!==!0&&(D!==!0||B.value===!0)&&l.focus(),e.onFilter!==void 0&&(C=setTimeout(()=>{C=null,ye(g.value)},e.inputDebounce)))}function Te(t,n){g.value!==t&&(g.value=t,n===!0||e.inputDebounce===0||e.inputDebounce==="0"?r("inputValue",t):x=setTimeout(()=>{x=null,r("inputValue",t)},e.inputDebounce))}function Ae(t,n,i){F=i!==!0,e.useInput===!0&&(Te(t,!0),(n===!0||i!==!0)&&(X=t),n!==!0&&ye(t))}function ye(t,n,i){if(e.onFilter===void 0||n!==!0&&l.focused.value!==!0)return;l.innerLoading.value===!0?r("filterAbort"):(l.innerLoading.value=!0,s.value=!0),t!==""&&e.multiple!==!0&&a.value.length!==0&&F!==!0&&t===G.value(a.value[0])&&(t="");const h=setTimeout(()=>{u.value===!0&&(u.value=!1)},10);R!==null&&clearTimeout(R),R=h,r("filter",t,(M,I)=>{(n===!0||l.focused.value===!0)&&R===h&&(clearTimeout(R),typeof M=="function"&&M(),s.value=!1,se(()=>{l.innerLoading.value=!1,l.editable.value===!0&&(n===!0?u.value===!0&&me():u.value===!0?$e(!0):u.value=!0),typeof I=="function"&&se(()=>{I(v)}),typeof i=="function"&&se(()=>{i(v)})}))},()=>{l.focused.value===!0&&R===h&&(clearTimeout(R),l.innerLoading.value=!1,s.value=!1),u.value===!0&&(u.value=!1)})}function kt(){return V(nl,{ref:L,class:w.value,style:e.popupContentStyle,modelValue:u.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&$.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:_.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:Pe.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...de.value,onScrollPassive:N,onBeforeShow:ct,onBeforeHide:It,onShow:Ot},ot)}function It(t){dt(t),be()}function Ot(){ue()}function Mt(t){Se(t),f.value?.focus(),B.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function qt(t){Se(t),se(()=>{B.value=!1})}function _t(){const t=[V(al,{class:`col-auto ${l.fieldClass.value}`,...y.value,for:l.targetUid.value,dark:_.value,square:!0,loading:s.value,itemAligned:!1,filled:!0,stackLabel:g.value.length!==0,...l.splitAttrs.listeners.value,onFocus:Mt,onBlur:qt},{...o,rawControl:()=>l.getControl(!0),before:void 0,after:void 0})];return u.value===!0&&t.push(V("div",{ref:A,class:w.value+" scroll",style:e.popupContentStyle,...de.value,onClick:Be,onScrollPassive:N},ot())),V(Xt,{ref:U,modelValue:q.value,position:e.useInput===!0?"top":void 0,transitionShow:c,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:ct,onBeforeHide:Et,onHide:Tt,onShow:Dt},()=>V("div",{class:"q-select__dialog"+(_.value===!0?" q-select__dialog--dark q-dark":"")+(B.value===!0?" q-select__dialog--focused":"")},t))}function Et(t){dt(t),U.value!==null&&U.value.__updateRefocusTarget(l.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),l.focused.value=!1}function Tt(t){me(),l.focused.value===!1&&r("blur",t),we()}function Dt(){const t=document.activeElement;(t===null||t.id!==l.targetUid.value)&&f.value!==null&&f.value!==t&&f.value.focus(),ue()}function be(){q.value!==!0&&(m.value=-1,u.value===!0&&(u.value=!1),l.focused.value===!1&&(R!==null&&(clearTimeout(R),R=null),l.innerLoading.value===!0&&(r("filterAbort"),l.innerLoading.value=!1,s.value=!1)))}function pe(t){l.editable.value===!0&&(D===!0?(l.onControlFocusin(t),q.value=!0,se(()=>{l.focus()})):l.focus(),e.onFilter!==void 0?ye(g.value):($.value!==!0||o["no-option"]!==void 0)&&(u.value=!0))}function me(){q.value=!1,be()}function we(){e.useInput===!0&&Ae(e.multiple!==!0&&e.fillInput===!0&&a.value.length!==0&&G.value(a.value[0])||"",!0,!0)}function $e(t){let n=-1;if(t===!0){if(a.value.length!==0){const i=te.value(a.value[0]);n=e.options.findIndex(h=>ke(te.value(h),i))}J(n)}he(n)}function Bt(t,n){u.value===!0&&l.innerLoading.value===!1&&(J(-1,!0),se(()=>{u.value===!0&&l.innerLoading.value===!1&&(t>n?J():$e(!0))}))}function st(){q.value===!1&&L.value!==null&&L.value.updatePosition()}function ct(t){t!==void 0&&Se(t),r("popupShow",t),l.hasPopupOpen=!0,l.onControlFocusin(t)}function dt(t){t!==void 0&&Se(t),r("popupHide",t),l.hasPopupOpen=!1,l.onControlFocusout(t)}function ft(){D=S.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?o["no-option"]!==void 0||e.onFilter!==void 0||$.value===!1:!0),c=S.platform.is.ios===!0&&D===!0&&e.useInput===!0?"fade":e.transitionShow}return Kt(ft),Qt(st),ft(),ht(()=>{C!==null&&clearTimeout(C),x!==null&&clearTimeout(x)}),Object.assign(v,{showPopup:pe,hidePopup:me,removeAtIndex:Ne,add:et,toggleOption:ve,getOptionIndex:()=>m.value,setOptionIndex:he,moveOptionSelection:Ee,filter:ye,updateMenuPosition:st,updateInputValue:Ae,isOptionSelected:je,getEmittingOptionValue:Ze,isOptionDisabled:(...t)=>ge.value.apply(null,t)===!0,getOptionValue:(...t)=>te.value.apply(null,t),getOptionLabel:(...t)=>G.value.apply(null,t)}),Object.assign(l,{innerValue:a,fieldClass:d(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:ee,targetRef:f,hasValue:j,showPopup:pe,floatingLabel:d(()=>e.hideSelected!==!0&&j.value===!0||typeof g.value=="number"||g.value.length!==0||Re(e.displayValue)),getControlChild:()=>{if(l.editable.value!==!1&&(q.value===!0||$.value!==!0||o["no-option"]!==void 0))return D===!0?_t():kt();l.hasPopupOpen===!0&&(l.hasPopupOpen=!1)},controlEvents:{onFocusin(t){l.onControlFocusin(t)},onFocusout(t){l.onControlFocusout(t,()=>{we(),be()})},onClick(t){if(Be(t),D!==!0&&u.value===!0){be(),f.value?.focus();return}pe(t)}},getControl:t=>{const n=zt(),i=t===!0||q.value!==!0||D!==!0;if(e.useInput===!0)n.push(At(t,i));else if(l.editable.value===!0){const M=i===!0?Me.value:void 0;n.push(V("input",{ref:i===!0?f:void 0,key:"d_t",class:"q-select__focus-target",id:i===!0?l.targetUid.value:void 0,value:Y.value,readonly:!0,"data-autofocus":t===!0||e.autofocus===!0||void 0,...M,onKeydown:it,onKeyup:lt,onKeypress:nt})),i===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&n.push(V("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:ut}))}if(T.value!==void 0&&e.disable!==!0&&_e.value.length!==0){const M=_e.value.map(I=>V("option",{value:I,selected:!0}));n.push(V("select",{class:"hidden",name:T.value,multiple:e.multiple},M))}const h=e.useInput===!0||i!==!0?void 0:l.splitAttrs.attributes.value;return V("div",{class:"q-field__native row items-center",...h,...l.splitAttrs.listeners.value},n)},getInnerAppend:()=>e.loading!==!0&&s.value!==!0&&e.hideDropdownIcon!==!0?[V(Ut,{class:"q-select__dropdown-icon"+(u.value===!0?" rotate-180":""),name:Fe.value})]:null}),Ge(l)}});function Ve(e,o,r,v){const S=[];return e.forEach(u=>{v(u)===!0?S.push(u):o.push({failedPropValidation:r,file:u})}),S}function De(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),ce(e)}const vl={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ml=["rejected"];function Sl({editable:e,dnd:o,getFileInput:r,addFilesToQueue:v}){const{props:S,emit:u,proxy:q}=He(),m=P(null),g=d(()=>S.accept!==void 0?S.accept.split(",").map(c=>(c=c.trim(),c==="*"?"*/":(c.endsWith("/*")&&(c=c.slice(0,c.length-1)),c.toUpperCase()))):null),B=d(()=>parseInt(S.maxFiles,10)),s=d(()=>parseInt(S.maxTotalSize,10));function C(c){if(e.value)if(c!==Object(c)&&(c={target:null}),c.target?.matches('input[type="file"]')===!0)c.clientX===0&&c.clientY===0&&Se(c);else{const E=r();E!==c.target&&E?.click(c)}}function x(c){e.value&&c&&v(null,c)}function k(c,E,O,ee){let f=Array.from(E||c.target.files);const L=[],U=()=>{L.length!==0&&u("rejected",L)};if(S.accept!==void 0&&g.value.indexOf("*/")===-1&&(f=Ve(f,L,"accept",A=>g.value.some(T=>A.type.toUpperCase().startsWith(T)||A.name.toUpperCase().endsWith(T))),f.length===0))return U();if(S.maxFileSize!==void 0){const A=parseInt(S.maxFileSize,10);if(f=Ve(f,L,"max-file-size",T=>T.size<=A),f.length===0)return U()}if(S.multiple!==!0&&f.length!==0&&(f=[f[0]]),f.forEach(A=>{A.__key=A.webkitRelativePath+A.lastModified+A.name+A.size}),ee===!0){const A=O.map(T=>T.__key);f=Ve(f,L,"duplicate",T=>A.includes(T.__key)===!1)}if(f.length===0)return U();if(S.maxTotalSize!==void 0){let A=ee===!0?O.reduce((T,ie)=>T+ie.size,0):0;if(f=Ve(f,L,"max-total-size",T=>(A+=T.size,A<=s.value)),f.length===0)return U()}if(typeof S.filter=="function"){const A=S.filter(f);f=Ve(f,L,"filter",T=>A.includes(T))}if(S.maxFiles!==void 0){let A=ee===!0?O.length:0;if(f=Ve(f,L,"max-files",()=>(A++,A<=B.value)),f.length===0)return U()}if(U(),f.length!==0)return f}function D(c){De(c),o.value!==!0&&(o.value=!0)}function F(c){ce(c),(c.relatedTarget!==null||Gt.is.safari!==!0?c.relatedTarget!==m.value:document.elementsFromPoint(c.clientX,c.clientY).includes(m.value)===!1)===!0&&(o.value=!1)}function R(c){De(c);const E=c.dataTransfer.files;E.length!==0&&v(null,E),o.value=!1}function X(c){if(o.value===!0)return V("div",{ref:m,class:`q-${c}__dnd absolute-full`,onDragenter:De,onDragover:De,onDragleave:F,onDrop:R})}return Object.assign(q,{pickFiles:C,addFiles:x}),{pickFiles:C,addFiles:x,onDragover:D,onDragleave:F,processFiles:k,getDndNode:X,maxFilesNumber:B,maxTotalSizeNumber:s}}const wl=We({name:"QFile",inheritAttrs:!1,props:{...Jt,...yt,...vl,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Xe,...ml],setup(e,{slots:o,emit:r,attrs:v}){const{proxy:S}=He(),u=Je(),q=P(null),m=P(!1),g=bt(e),{pickFiles:B,onDragover:s,onDragleave:C,processFiles:x,getDndNode:k}=Sl({editable:u.editable,dnd:m,getFileInput:W,addFilesToQueue:ae}),D=Zt(e),F=d(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),R=d(()=>Re(F.value)),X=d(()=>F.value.map(p=>p.name).join(", ")),c=d(()=>il(F.value.reduce((p,N)=>p+N.size,0))),E=d(()=>({totalSize:c.value,filesNumber:F.value.length,maxFiles:e.maxFiles})),O=d(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:g.value,...v,id:u.targetUid.value,disabled:u.editable.value!==!0})),ee=d(()=>"q-file q-field--auto-height"+(m.value===!0?" q-file--dnd":"")),f=d(()=>e.multiple===!0&&e.append===!0);function L(p){const N=F.value.slice();N.splice(p,1),A(N)}function U(p){const N=F.value.indexOf(p);N!==-1&&L(N)}function A(p){r("update:modelValue",e.multiple===!0?p:p[0])}function T(p){p.keyCode===13&&Be(p)}function ie(p){(p.keyCode===13||p.keyCode===32)&&B(p)}function W(){return q.value}function ae(p,N){const K=x(p,N,F.value,f.value),ue=W();ue!=null&&(ue.value=""),K!==void 0&&((e.multiple===!0?e.modelValue&&K.every(l=>F.value.includes(l)):e.modelValue===K[0])||A(f.value===!0?F.value.concat(K):K))}function le(){return[V("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function oe(){if(o.file!==void 0)return F.value.length===0?le():F.value.map((N,K)=>o.file({index:K,file:N,ref:this}));if(o.selected!==void 0)return F.value.length===0?le():o.selected({files:F.value,ref:this});if(e.useChips===!0)return F.value.length===0?le():F.value.map((N,K)=>V(pt,{key:"file-"+K,removable:u.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{L(K)}},()=>V("span",{class:"ellipsis",textContent:N.name})));const p=e.displayValue!==void 0?e.displayValue:X.value;return p.length!==0?[V("div",{class:e.inputClass,style:e.inputStyle,textContent:p})]:le()}function J(){const p={ref:q,...O.value,...D.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:ae};return e.multiple===!0&&(p.multiple=!0),V("input",p)}return Object.assign(u,{fieldClass:ee,emitValue:A,hasValue:R,inputRef:q,innerValue:F,floatingLabel:d(()=>R.value===!0||Re(e.displayValue)),computedCounter:d(()=>{if(e.counterLabel!==void 0)return e.counterLabel(E.value);const p=e.maxFiles;return`${F.value.length}${p!==void 0?" / "+p:""} (${c.value})`}),getControlChild:()=>k("file"),getControl:()=>{const p={ref:u.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return u.editable.value===!0&&Object.assign(p,{onDragover:s,onDragleave:C,onKeydown:T,onKeyup:ie}),V("div",p,[J()].concat(oe()))}}),Object.assign(S,{removeAtIndex:L,removeFile:U,getNativeElement:()=>q.value}),el(S,"nativeEl",()=>q.value),Ge(u)}});export{pl as Q,wl as a};
